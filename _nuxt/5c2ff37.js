(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{388:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},389:function(e,t,r){"use strict";var n=r(2),o=r(390).trim;n({target:"String",proto:!0,forced:r(391)("trim")},{trim:function(){return o(this)}})},390:function(e,t,r){var n=r(18),o="["+r(388)+"]",c=RegExp("^"+o+o+"*"),l=RegExp(o+o+"*$"),d=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(c,"")),2&e&&(r=r.replace(l,"")),r}};e.exports={start:d(1),end:d(2),trim:d(3)}},391:function(e,t,r){var n=r(5),o=r(388);e.exports=function(e){return n((function(){return!!o[e]()||"​᠎"!="​᠎"[e]()||o[e].name!==e}))}},555:function(e,t,r){var content=r(595);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(21).default)("f0a9e39e",content,!0,{sourceMap:!1})},594:function(e,t,r){"use strict";r(555)},595:function(e,t,r){var n=r(20)(!1);n.push([e.i,".air-column[data-v-78736cbd]{border-bottom:1px dashed #ddd;padding-bottom:20px;margin-bottom:20px}.air-column h2[data-v-78736cbd]{margin-bottom:20px;font-size:22px;font-weight:400}[data-v-78736cbd] .el-select .el-input{width:130px}.input-with-select[data-v-78736cbd]{width:590px}.input-with-select[data-v-78736cbd] .el-input-group__prepend{background-color:#fff}.member-info[data-v-78736cbd] .el-form-item{margin-bottom:0}.member-info[data-v-78736cbd] .el-form-item /deep/ .el-form-item__error{margin-top:10px;margin-left:130px}.member-info-item[data-v-78736cbd]{border-bottom:1px dashed #eee;padding-bottom:20px;position:relative}.add-member[data-v-78736cbd]{margin-top:20px}.delete-user[data-v-78736cbd]{display:block;background:#ddd;width:20px;height:20px;font-size:14px;text-align:center;line-height:18px;color:#fff;cursor:pointer;border-radius:50px;position:absolute;right:-30px;top:57%}.insurance>div[data-v-78736cbd]{margin-top:10px}.insurance-item[data-v-78736cbd]{margin-bottom:20px}.contact[data-v-78736cbd] .el-input{width:50%}.submit[data-v-78736cbd]{margin:50px auto;display:block;width:250px;height:50px}",""]),e.exports=n},642:function(e,t,r){"use strict";r.r(t);r(36),r(110),r(389),r(244);var n={computed:{allPriceCheckInsurances:function(){var e=this;if(!this.detail.seat_infos)return 0;var t=0,r=this.form.users.length,n=[];return t+=this.detail.seat_infos.org_settle_price*r,t+=this.detail.airport_tax_audlet*r,this.form.insurances.forEach((function(o){e.detail.insurances.forEach((function(e){o===e.id&&(t+=e.price*r,n.push({name:"".concat(e.type,"：￥").concat(e.price,"/份"),num:"x".concat(r)}))}))})),this.$emit("setData",{price:t,checkInsurances:n,people:r}),{price:t,checkInsurances:n,people:r}}},mounted:function(){var e=this,t=this.$route.query,r=t.id,n=t.seat_xid;this.form.air=r,this.form.seat_xid=n,this.$axios({url:"/airs/".concat(r),params:{id:r,seat_xid:n}}).then((function(t){console.log(t.data),e.$store.commit("air/setDetail",t.data),e.detail=t.data}))},data:function(){return{detail:{},form:{users:[{username:"",id:""}],insurances:[],contactName:"",contactPhone:"",captcha:"",invoice:!1,seat_xid:"",air:""},rules:{users:[{validator:function(e,t,r){console.log(t),t.every((function(e){var t=!0;return e.username.trim()?e.id.trim()?t:(t=!1,r(new Error("证件类型不能为空"))):(t=!1,r(new Error("乘机人信息不能为空")))}))&&r()},trigger:"blur"}],contactName:[{required:!0,message:"联系人姓名不能为空",trigger:"change"}],contactPhone:[{required:!0,message:"联系人手机号不能为空",trigger:"change"},{min:11,max:11,message:"手机号长度应为11位",trigger:"blur"}],captcha:[{required:!0,message:"短信验证码不能为空",trigger:"change"}]}}},methods:{handleInsurances:function(e){var t=this.form.insurances.indexOf(e);-1===t?this.form.insurances.push(e):this.form.insurances.splice(t,1)},handleAddUsers:function(){this.form.users.push({username:"",id:""})},handleDeleteUser:function(e){this.form.users.splice(e,1)},handleSendCaptcha:function(){var e=this,t=this.form.contactPhone.trim();t&&11===t.length?this.$store.dispatch("user/sendCaptcha",t).then((function(t){e.$message.success("验证码发送成功："+t)})):this.$refs.form.validateField("contactPhone")},handleSubmit:function(){var e=this;this.$refs.form.validate((function(t){t&&(console.log(e.form),e.$axios({url:"/airorders",method:"POST",data:e.form,headers:{Authorization:"Bearer "+e.$store.state.user.userInfo.token}}).then((function(t){var r=t.data.message;e.$message.success(r);var n=t.data.data.id;e.$router.push({path:"/air/pay",query:{id:n}}).then((function(e){console.log(e)}))})))}))}}},o=(r(594),r(22)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main"},[r("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form}},[r("div",{staticClass:"air-column"},[r("h2",[e._v("剩机人")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(e.allPriceCheckInsurances))]),e._v(" "),e._l(e.form.users,(function(t,n){return r("div",{key:n,staticClass:"member-info member-info-item"},[r("el-form-item",{attrs:{prop:"users"}},[r("el-form-item",{attrs:{label:"乘机人类型"}},[r("el-input",{staticClass:"input-with-select",attrs:{placeholder:"姓名"},model:{value:t.username,callback:function(r){e.$set(t,"username",r)},expression:"item.username"}},[r("el-select",{attrs:{slot:"prepend",value:"1",placeholder:"请选择"},slot:"prepend"},[r("el-option",{attrs:{label:"成人",value:"1"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"证件类型"}},[r("el-input",{staticClass:"input-with-select",attrs:{placeholder:"证件号码"},model:{value:t.id,callback:function(r){e.$set(t,"id",r)},expression:"item.id"}},[r("el-select",{attrs:{slot:"prepend",value:"1",placeholder:"请选择"},slot:"prepend"},[r("el-option",{attrs:{label:"身份证",value:"1",checked:!0}})],1)],1)],1),e._v(" "),0!==n?r("span",{staticClass:"delete-user",on:{click:function(t){return e.handleDeleteUser(n)}}},[e._v("—")]):e._e()],1)],1)})),e._v(" "),r("el-button",{staticClass:"add-member",attrs:{type:"primary"},on:{click:e.handleAddUsers}},[e._v("添加乘机人")])],2),e._v(" "),r("div",{staticClass:"air-column"},[r("h2",[e._v("保险")]),e._v(" "),r("div",e._l(e.detail.insurances,(function(t,n){return r("div",{key:n,staticClass:"insurance-item"},[r("el-checkbox",{attrs:{label:t.type+"：￥"+t.price+"/份×"+e.form.users.length+" 最高赔付"+t.compensation.replace("万","")+"万",border:""},on:{change:function(r){return e.handleInsurances(t.id)}}})],1)})),0)]),e._v(" "),r("div",{staticClass:"air-column"},[r("h2",[e._v("联系人")]),e._v(" "),r("div",{staticClass:"contact"},[r("el-form-item",{attrs:{label:"姓名","label-width":"80px",prop:"contactName"}},[r("el-input",{model:{value:e.form.contactName,callback:function(t){e.$set(e.form,"contactName",t)},expression:"form.contactName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号","label-width":"80px",prop:"contactPhone"}},[r("el-input",{model:{value:e.form.contactPhone,callback:function(t){e.$set(e.form,"contactPhone",t)},expression:"form.contactPhone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"验证码","label-width":"80px",prop:"captcha"}},[r("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.form.captcha,callback:function(t){e.$set(e.form,"captcha",t)},expression:"form.captcha"}},[r("template",{slot:"append"},[r("el-button",{on:{click:e.handleSendCaptcha}},[e._v("发送验证码")])],1)],2)],1),e._v(" "),r("el-button",{staticClass:"submit",attrs:{type:"warning"},on:{click:e.handleSubmit}},[e._v("提交订单")])],1)])])],1)}),[],!1,null,"78736cbd",null);t.default=component.exports}}]);